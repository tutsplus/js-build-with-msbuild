(function(a){a.widget("ui.menubar",{version:"@VERSION",options:{autoExpand:false,buttons:false,items:"li",menuElement:"ul",menuIcon:false,position:{my:"left top",at:"left bottom"}},_create:function(){var b=this;this.menuItems=this.element.children(this.options.items);this.items=this.menuItems.children("button, a");this.menuItems.addClass("ui-menubar-item").attr("role","presentation");this.items.slice(1).attr("tabIndex",-1);this.element.addClass("ui-menubar ui-widget-header ui-helper-clearfix").attr("role","menubar");this._focusable(this.items);this._hoverable(this.items);this.items.siblings(this.options.menuElement).menu({position:{within:this.options.position.within},select:function(c,d){d.item.parents("ul.ui-menu:last").hide();b._close();a(c.target).prev().focus();b._trigger("select",c,d)},menus:b.options.menuElement}).hide().attr({"aria-hidden":"true","aria-expanded":"false"}).bind("keydown.menubar",function(c){var d=a(this);if(d.is(":hidden")){return}switch(c.keyCode){case a.ui.keyCode.LEFT:b.previous(c);c.preventDefault();break;case a.ui.keyCode.RIGHT:b.next(c);c.preventDefault();break}});this.items.each(function(){var c=a(this),d=c.next(b.options.menuElement);if(d.length){c.bind("click.menubar focus.menubar mouseenter.menubar",function(e){if(e.type==="focus"&&!e.originalEvent){return}e.preventDefault();if(e.type==="click"&&d.is(":visible")&&b.active&&b.active[0]===d[0]){b._close();return}if((b.open&&e.type==="mouseenter")||e.type==="click"||b.options.autoExpand){if(b.options.autoExpand){clearTimeout(b.closeTimer)}b._open(e,d)}}).bind("keydown",function(e){switch(e.keyCode){case a.ui.keyCode.SPACE:case a.ui.keyCode.UP:case a.ui.keyCode.DOWN:b._open(e,a(this).next());e.preventDefault();break;case a.ui.keyCode.LEFT:b.previous(e);e.preventDefault();break;case a.ui.keyCode.RIGHT:b.next(e);e.preventDefault();break}}).attr("aria-haspopup","true");if(b.options.menuIcon){c.addClass("ui-state-default").append("<span class='ui-button-icon-secondary ui-icon ui-icon-triangle-1-s'></span>");c.removeClass("ui-button-text-only").addClass("ui-button-text-icon-secondary")}}else{c.bind("click.menubar mouseenter.menubar",function(e){if((b.open&&e.type==="mouseenter")||e.type==="click"){b._close()}})}c.addClass("ui-button ui-widget ui-button-text-only ui-menubar-link").attr("role","menuitem").wrapInner("<span class='ui-button-text'></span>");if(b.options.buttons){c.removeClass("ui-menubar-link").addClass("ui-state-default")}});b._on({keydown:function(c){if(c.keyCode===a.ui.keyCode.ESCAPE&&b.active&&b.active.menu("collapse",c)!==true){var d=b.active;b.active.blur();b._close(c);d.prev().focus()}},focusin:function(c){clearTimeout(b.closeTimer)},focusout:function(c){b.closeTimer=setTimeout(function(){b._close(c)},150)},"mouseleave .ui-menubar-item":function(c){if(b.options.autoExpand){b.closeTimer=setTimeout(function(){b._close(c)},150)}},"mouseenter .ui-menubar-item":function(c){clearTimeout(b.closeTimer)}});this.openSubmenus=0},_destroy:function(){this.menuItems.removeClass("ui-menubar-item").removeAttr("role");this.element.removeClass("ui-menubar ui-widget-header ui-helper-clearfix").removeAttr("role").unbind(".menubar");this.items.unbind(".menubar").removeClass("ui-button ui-widget ui-button-text-only ui-menubar-link ui-state-default").removeAttr("role").removeAttr("aria-haspopup").children("span.ui-button-text").each(function(b,d){var c=a(this);c.parent().html(c.html())}).end().children(".ui-icon").remove();this.element.find(":ui-menu").menu("destroy").show().removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("tabindex").unbind(".menubar")},_close:function(){if(!this.active||!this.active.length){return}this.active.menu("collapseAll").hide().attr({"aria-hidden":"true","aria-expanded":"false"});this.active.prev().removeClass("ui-state-active").removeAttr("tabIndex");this.active=null;this.open=false;this.openSubmenus=0},_open:function(c,d){if(this.active&&this.active[0]===d[0]){return}if(this.active){this.active.menu("collapseAll").hide().attr({"aria-hidden":"true","aria-expanded":"false"});this.active.prev().removeClass("ui-state-active")}var b=d.prev().addClass("ui-state-active").attr("tabIndex",-1);this.active=d.show().position(a.extend({of:b},this.options.position)).removeAttr("aria-hidden").attr("aria-expanded","true").menu("focus",c,d.children(".ui-menu-item").first()).focus().focusin();this.open=true},next:function(b){if(this.open&&this.active.data("menu").active.has(".ui-menu").length){this.openSubmenus++;return}this.openSubmenus=0;this._move("next","first",b)},previous:function(b){if(this.open&&this.openSubmenus){this.openSubmenus--;return}this.openSubmenus=0;this._move("prev","last",b)},_move:function(f,d,e){var c,b;if(this.open){c=this.active.closest(".ui-menubar-item")[f+"All"](this.options.items).first().children(".ui-menu").eq(0);b=this.menuItems[d]().children(".ui-menu").eq(0)}else{if(e){c=a(e.target).closest(".ui-menubar-item")[f+"All"](this.options.items).children(".ui-menubar-link").eq(0);b=this.menuItems[d]().children(".ui-menubar-link").eq(0)}else{c=b=this.menuItems.children("a").eq(0)}}if(c.length){if(this.open){this._open(e,c)}else{c.removeAttr("tabIndex")[0].focus()}}else{if(this.open){this._open(e,b)}else{b.removeAttr("tabIndex")[0].focus()}}}})}(jQuery));